(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{285:(e,t,i)=>{"use strict";i.d(t,{$:()=>d});var s=i(5155),r=i(2115),n=i(4253),a=i(2085),o=i(9434);let l=(0,a.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:i,variant:r,size:a,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,s.jsx)(u,{className:(0,o.cn)(l({variant:r,size:a,className:i})),ref:t,...c})});d.displayName="Button"},3621:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>W});var s=i(5155),r=i(2115),n=i(5695),a=i(535),o=i(9298),l=i(285),d=i(6695),c=i(3262),u=i(9434),m=i(7481);function f(e){let{title:t,description:i,onSubmit:n}=e,[a,o]=(0,r.useState)(null),{toast:c}=(0,m.dj)();return(0,s.jsxs)(d.Zp,{className:"shadow-lg animate-in fade-in-50 duration-500",children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsx)(d.ZB,{className:"font-headline text-center",children:t}),(0,s.jsx)(d.BT,{className:"text-center",children:i})]}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)("div",{className:"flex justify-center gap-2 md:gap-4",children:[1,2,3,4,5].map(e=>(0,s.jsx)(l.$,{variant:"outline",size:"icon",className:(0,u.cn)("h-12 w-12 rounded-full text-lg font-bold transition-all duration-200",a===e?"bg-accent text-accent-foreground scale-110":"bg-background"),onClick:()=>o(e),children:e},e))})}),(0,s.jsx)(d.wL,{children:(0,s.jsx)(l.$,{className:"w-full",onClick:()=>{if(null===a)return void c({title:"Selection required",description:"Please select a stress level before submitting.",variant:"destructive"});n(a)},children:"Submit"})})]})}function p(e){let{affirmation:t,onContinue:i}=e;return(0,s.jsxs)(d.Zp,{className:"shadow-lg text-center animate-in fade-in-50 duration-500",children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsx)(d.ZB,{className:"font-headline",children:"Your Affirmation"}),(0,s.jsx)(d.BT,{children:"Take a moment to read and reflect."})]}),(0,s.jsx)(d.Wu,{children:(0,s.jsxs)("p",{className:"text-2xl font-semibold font-headline text-accent-foreground leading-relaxed",children:['"',t,'"']})}),(0,s.jsx)(d.wL,{children:(0,s.jsxs)(l.$,{className:"w-full",onClick:i,children:["Continue ",(0,s.jsx)(c.Qp,{className:"ml-2 h-4 w-4"})]})})]})}let h=["My child sees the world with clarity and honesty, reminding me to embrace truth and authenticity in all I do.","Parenting my child has made me more patient, compassionate, and understanding—not just as a parent, but as a person.","I have learned to focus on what I can control, creating a safe and loving environment where my child can thrive.","My child's sense of justice, kindness, and inclusion inspires me to be a better advocate for all.","Through my child's eyes, I see the beauty in the small victories—every milestone is a triumph worth celebrating.","I have gained strength, resilience, and a powerful voice by advocating for my child—and in doing so, I have learned to advocate for myself too.","The way my child experiences joy—through flapping their arms, jumping, and laughing—teaches me to embrace happiness in its purest form.","My child’s love for their passions is contagious, reminding me that curiosity and excitement are gifts to be cherished.","Because of my child, I see the world differently—not as it is expected to be, but as it truly is.","My child has taught me the power of communication beyond words—every gesture, every look, every sound is filled with meaning.","I no longer worry about the judgments of others. I focus on my child, their needs, their joy, and their incredible journey.","I am part of a wonderful community of parents who support, uplift, and inspire one another—this journey is never walked alone.","My child’s presence in my life is a privilege, a daily reminder that being different is not only okay—it is beautiful.","I am forever grateful for the lessons my child teaches me—patience, acceptance, and the courage to see the world in a new way."];var g=i(9672);let v=g.Kq,x=g.bL,w=g.l9,y=r.forwardRef((e,t)=>{let{className:i,sideOffset:r=4,...n}=e;return(0,s.jsx)(g.UC,{ref:t,sideOffset:r,className:(0,u.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",i),...n})});y.displayName=g.UC.displayName;var b=i(5317),j=i(6104);async function N(e){console.log("Inside saveStressData:"),console.log("Data to be saved:",e);try{let t=await (0,b.gS)((0,b.rJ)(j.db,"stressData"),e);return console.log("Document written with ID: ",t.id),{success:!0,id:t.id}}catch(e){if(console.error("Error adding document: ",e),e instanceof Error)return{success:!1,error:e.message};return{success:!1,error:"Failed to save data"}}}var S=i(9229),k=i(996);async function T(){try{if(!await (0,k.TT)())return console.log("Firebase Messaging is not supported in this browser"),null;let e=await Notification.requestPermission();if("granted"===e){if(console.log("Notification permission granted."),"serviceWorker"in navigator)for(let e of(await navigator.serviceWorker.getRegistrations()))console.log("Unregistering existing service worker:",e.scope),await e.unregister();if(await new Promise(e=>setTimeout(e,500)),"serviceWorker"in navigator)try{let e=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/"});console.log("Service Worker registered:",e),e.installing&&await new Promise(t=>{e.installing.addEventListener("statechange",function(){"activated"===this.state&&t(null)})}),await navigator.serviceWorker.ready,console.log("Service Worker is ready")}catch(e){return console.error("Service Worker registration failed:",e),null}let e=(0,k.dG)(j.y),t=null,i=0;for(;!t&&i<3;)try{if(t=await (0,k.gf)(e,{vapidKey:"BAflMYuUiIVjaCaCxmVmwYp8801GpsUz5ic5hLsymTpnZEr2DrnHfwL7PLdPpi84JY8QKRqcl2bNqJtnbEFRpm0",serviceWorkerRegistration:await navigator.serviceWorker.ready})){console.log("FCM Token obtained successfully");break}}catch(e){if(i++,console.warn("Token retrieval attempt ".concat(i,"/").concat(3," failed:"),e.message),i<3)await new Promise(e=>setTimeout(e,1e3*i));else throw e}if(t)return console.log("FCM Token:",t),t;return console.log("No registration token available. Check service worker registration."),null}if("denied"===e)return console.log("Notification permission denied."),null;return console.log("Notification permission not granted yet."),null}catch(e){return console.error("An error occurred while requesting notification permission:",e),null}}async function I(e){try{if(!await (0,k.TT)())return void console.log("Firebase Messaging is not supported");let t=(0,k.dG)(j.y);(0,k.xD)(t,t=>{if(console.log("Message received in foreground:",t),t.notification){let e=t.notification.title||"BRAIN KIT",i={body:t.notification.body||"You have a new notification",icon:"/brain-kit-capacitor-logo.png",badge:"/brain-kit-capacitor-logo.png",tag:"brain-kit-notification",requireInteraction:!1,vibrate:[200,100,200],data:t.data||{},silent:!1},s=new Notification(e,i);s.onclick=e=>{var i;e.preventDefault(),window.focus(),s.close(),(null==(i=t.data)?void 0:i.url)&&(window.location.href=t.data.url)},console.log("System tray notification shown in foreground")}e(t)})}catch(e){console.error("Error setting up message listener:",e)}}async function E(e,t){try{let{db:s}=await Promise.resolve().then(i.bind(i,6104)),{doc:r,updateDoc:n,arrayUnion:a}=await Promise.resolve().then(i.bind(i,5317)),o=r(s,"users",e);await n(o,{fcmTokens:a(t),lastTokenUpdate:new Date().toISOString()}),console.log("FCM token saved to user document")}catch(e){console.error("Error saving FCM token:",e)}}function C(){let{user:e}=(0,a.A)(),{toast:t}=(0,m.dj)(),[i,n]=(0,r.useState)("unknown"),[o,u]=(0,r.useState)(!1),[f,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if("Notification"in window){let t=Notification.permission;n(t);let i=localStorage.getItem("notification-prompt-dismissed");"default"!==t||i||p(!0),"granted"===t&&e&&h()}},[e]);let h=async()=>{if(e){u(!0);try{let i=await T();i?(await E(e.uid,i),n("granted"),localStorage.removeItem("notification-prompt-dismissed"),t({title:"Notifications enabled!",description:"You will receive reminders for your daily affirmations."}),I(e=>{var i,s;console.log("Received notification:",e),t({title:(null==(i=e.notification)?void 0:i.title)||"Notification",description:(null==(s=e.notification)?void 0:s.body)||""})})):(n("denied"),t({title:"Notifications blocked",description:"Please enable notifications in your browser settings to receive reminders.",variant:"destructive"}))}catch(e){console.error("Error setting up notifications:",e),t({title:"Error",description:"Failed to set up notifications. Please try again.",variant:"destructive"})}finally{u(!1)}}},g=async()=>{await h()};return"granted"!==i&&(f||"denied"===i)&&"Notification"in window?(0,s.jsxs)(d.Zp,{className:"mb-4 border-primary/50 bg-primary/5",children:[(0,s.jsxs)(d.aR,{className:"relative",children:[(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 h-6 w-6",onClick:()=>{p(!1),localStorage.setItem("notification-prompt-dismissed","true")},children:(0,s.jsx)(c.X,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Ir,{className:"h-5 w-5 text-primary"}),(0,s.jsx)(d.ZB,{className:"text-lg",children:"Enable Notifications"})]}),(0,s.jsxs)(d.BT,{children:["Stay on track with your daily affirmations. We'll send you gentle reminders morning and evening.","denied"===i&&(0,s.jsx)("span",{className:"block mt-2 text-destructive font-medium",children:"Notifications are currently blocked. Please enable them in your browser settings."})]})]}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)(l.$,{onClick:g,disabled:o,className:"w-full",children:o?"Setting up...":"denied"===i?"Open Browser Settings":"Enable Notifications"})})]}):null}function A(){let{user:e}=(0,a.A)(),{toast:t}=(0,m.dj)(),[i,n]=(0,r.useState)("default"),[o,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{"Notification"in window&&(n(Notification.permission),"granted"===Notification.permission&&I(e=>{var i,s;console.log("Received notification:",e),t({title:(null==(i=e.notification)?void 0:i.title)||"Notification",description:(null==(s=e.notification)?void 0:s.body)||""})}))},[]);let u=async()=>{if(e){if("granted"===i)return void t({title:"Notifications are enabled",description:"To disable, go to your browser settings → Site Settings → Notifications"});d(!0);try{let i=await T();i?(await E(e.uid,i),n("granted"),t({title:"Notifications enabled!",description:"You will receive reminders for your daily affirmations."}),I(e=>{var i,s;console.log("Received notification:",e),t({title:(null==(i=e.notification)?void 0:i.title)||"Notification",description:(null==(s=e.notification)?void 0:s.body)||""})})):(n("denied"),t({title:"Notifications blocked",description:"Please enable notifications in your browser settings.",variant:"destructive"}))}catch(e){console.error("Error toggling notifications:",e),t({title:"Error",description:"Failed to enable notifications. Please try again.",variant:"destructive"})}finally{d(!1)}}};if(!("Notification"in window))return null;let f="granted"===i,p="denied"===i;return(0,s.jsx)(v,{children:(0,s.jsxs)(x,{children:[(0,s.jsx)(w,{asChild:!0,children:(0,s.jsxs)(l.$,{variant:f?"default":"outline",size:"icon",onClick:u,disabled:o,className:p?"opacity-50":"",children:[f?(0,s.jsx)(c.Ir,{className:"h-4 w-4"}):(0,s.jsx)(c.br,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:f?"Notifications enabled":"Enable notifications"})]})}),(0,s.jsx)(y,{children:(0,s.jsx)("p",{children:f?"Notifications are enabled":p?"Notifications blocked - check browser settings":"Click to enable notifications"})})]})})}let D=()=>{let e=window.navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(e)},R=()=>{let e=window.navigator.userAgent.toLowerCase();return/android/.test(e)},B=()=>!!(window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone||document.referrer.includes("android-app://"));function M(){let{toast:e}=(0,m.dj)(),[t,i]=(0,r.useState)(null),[n,a]=(0,r.useState)(!1),[o,u]=(0,r.useState)(!1),[f,p]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(B())return void a(!0);D()?(p("ios"),localStorage.getItem("pwa-install-dismissed-ios")||u(!0)):R()?p("android"):p("desktop");let e=e=>{e.preventDefault(),i(e),localStorage.getItem("pwa-install-dismissed")||u(!0),console.log("PWA install prompt available")},t=()=>{console.log("PWA was installed"),a(!0),u(!1),i(null),localStorage.removeItem("pwa-install-dismissed"),localStorage.removeItem("pwa-install-dismissed-ios")};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",t),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",t)}},[]);let h=async()=>{if(t)try{await t.prompt();let s=await t.userChoice;"accepted"===s.outcome?(console.log("User accepted the install prompt"),a(!0),e({title:"App installed!",description:"BRAIN KIT has been added to your home screen."})):(console.log("User dismissed the install prompt"),e({title:"Installation cancelled",description:"You can install the app later from the menu."})),i(null),u(!1)}catch(e){console.error("Error showing install prompt:",e)}},g=()=>{u(!1),"ios"===f?localStorage.setItem("pwa-install-dismissed-ios","true"):localStorage.setItem("pwa-install-dismissed","true")};return n||!o?null:"ios"===f?(0,s.jsxs)(d.Zp,{className:"mb-4 border-primary/50 bg-primary/5",children:[(0,s.jsxs)(d.aR,{className:"relative",children:[(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 h-6 w-6",onClick:g,children:(0,s.jsx)(c.X,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.f5,{className:"h-5 w-5 text-primary"}),(0,s.jsx)(d.ZB,{className:"text-lg",children:"Install App (iOS)"})]}),(0,s.jsxs)(d.BT,{className:"space-y-2 text-left",children:[(0,s.jsx)("p",{children:"To install BRAIN KIT on your iPhone/iPad:"}),(0,s.jsxs)("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[(0,s.jsxs)("li",{children:["Tap the ",(0,s.jsx)("strong",{children:"Share"})," button (square with arrow)"]}),(0,s.jsxs)("li",{children:["Scroll down and tap ",(0,s.jsx)("strong",{children:"Add to Home Screen"})]}),(0,s.jsxs)("li",{children:["Tap ",(0,s.jsx)("strong",{children:"Add"})," in the top right corner"]})]})]})]}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)(l.$,{variant:"secondary",onClick:g,className:"w-full",children:"Got it"})})]}):(0,s.jsxs)(d.Zp,{className:"mb-4 border-primary/50 bg-primary/5",children:[(0,s.jsxs)(d.aR,{className:"relative",children:[(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 h-6 w-6",onClick:g,children:(0,s.jsx)(c.X,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.f5,{className:"h-5 w-5 text-primary"}),(0,s.jsx)(d.ZB,{className:"text-lg",children:"Install App"})]}),(0,s.jsx)(d.BT,{children:"Install BRAIN KIT to your home screen for a better experience with faster loading and offline access."})]}),(0,s.jsxs)(d.Wu,{children:[(0,s.jsx)(l.$,{onClick:h,className:"w-full",disabled:!t,children:t?"Install to Home Screen":"Install via Browser Menu"}),!t&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"Use your browser's menu to install this app"})]})]})}let P=()=>{let e=window.navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(e)},O=()=>!!(window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone||document.referrer.includes("android-app://"));function L(){let{toast:e}=(0,m.dj)(),[t,i]=(0,r.useState)(null),[n,a]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),[u,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(O())return void a(!0);P()?(f("ios"),d(!0)):f("other");let e=e=>{e.preventDefault(),i(e),d(!0),console.log("PWA install prompt available")},t=()=>{console.log("PWA was installed"),a(!0),d(!1),i(null)};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",t),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",t)}},[]);let p=async()=>{if("ios"===u)e({title:"Install on iOS",description:'1. Tap the Share button (⬆️)\n2. Scroll and tap "Add to Home Screen"\n3. Tap "Add"',duration:1e4});else if(t)try{await t.prompt();let s=await t.userChoice;"accepted"===s.outcome?(console.log("User accepted the install prompt"),a(!0),e({title:"App installed!",description:"BRAIN KIT has been added to your home screen."})):console.log("User dismissed the install prompt"),i(null)}catch(e){console.error("Error showing install prompt:",e)}else e({title:"Install via browser menu",description:"Use your browser's menu to install this app to your home screen.",duration:5e3})};return n||!o?null:(0,s.jsx)(v,{children:(0,s.jsxs)(x,{children:[(0,s.jsx)(w,{asChild:!0,children:(0,s.jsxs)(l.$,{onClick:p,size:"lg",className:"fixed bottom-6 right-6 rounded-full shadow-lg h-14 w-14 z-50",style:{bottom:"max(1.5rem, calc(1.5rem + var(--safe-area-inset-bottom)))",right:"max(1.5rem, calc(1.5rem + var(--safe-area-inset-right)))"},children:[(0,s.jsx)(c.f5,{className:"h-6 w-6"}),(0,s.jsx)("span",{className:"sr-only",children:"Install App"})]})}),(0,s.jsx)(y,{side:"left",children:(0,s.jsx)("p",{children:"Install app to home screen"})})]})})}function W(){let{user:e,loading:t,logout:i}=(0,a.A)(),u=(0,n.useRouter)(),{toast:g}=(0,m.dj)(),[k,T]=(0,r.useState)("idle"),[I,E]=(0,r.useState)({pre:null,post:null}),[D,R]=(0,r.useState)(""),[B,P]=(0,r.useState)(null),[O,W]=(0,r.useState)(null),[_,z]=(0,r.useState)(!1),[Z,$]=(0,r.useState)(null),U=(0,o.h)(),[F,Y]=(0,r.useState)(null),[H,q]=(0,r.useState)(null),[K,G]=(0,r.useState)(null);(0,r.useEffect)(()=>{t||e||(console.log("No user found, redirecting to login"),u.push("/login"))},[e,t,u]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{t&&(console.warn("Loading timeout - forcing redirect to login"),u.push("/login"))},5e3);return()=>clearTimeout(e)},[t,u]),(0,r.useEffect)(()=>{if(z(!0),W(new Date().getHours()),(null==e?void 0:e.studyStartDate)&&($((0,S.Mm)(e.studyStartDate)),!e.hasCompletedStudy&&(0,S._n)(e.studyStartDate))){let t=(0,b.doc)(j.db,"users",e.uid);(0,b.updateDoc)(t,{hasCompletedStudy:!0}).catch(e=>{console.error("Error updating hasCompletedStudy flag:",e)})}},[e]);let V=t=>{if(!(null==e?void 0:e.studyStartDate))return void g({title:"Error",description:"Study start date not found. Please contact support.",variant:"destructive"});R(h[(0,S.Bj)(e.studyStartDate,"morning"===t)]),P(t),Y(new Date),T("pre-stress")},X=async t=>{if(!e)return void g({title:"Error",description:"You must be logged in to save stress data.",variant:"destructive"});if(null===I.pre||!B)return void g({title:"Error",description:"Could not save your response due to missing pre-stress data or affirmation type.",variant:"destructive"});if(!F||!H||!K)return void g({title:"Error",description:"Could not save your response due to missing time tracking data.",variant:"destructive"});let i=new Date,s=Math.round((K.getTime()-H.getTime())/1e3),r=Math.round((i.getTime()-F.getTime())/1e3),n={creatorId:e.uid,affirmationType:B,affirmation:D,stressBefore:I.pre,stressAfter:t,timestamp:new Date().toISOString(),flowStartTime:F.toISOString(),affirmationStartTime:H.toISOString(),affirmationEndTime:K.toISOString(),flowEndTime:i.toISOString(),affirmationDurationSeconds:s,totalFlowDurationSeconds:r};E({pre:I.pre,post:t});try{let e=await N(n);e.success?(console.log("Stress data successfully saved!"),g({title:"Stress data saved!",description:"Your stress data has been successfully recorded."}),T("complete")):(console.error("Error saving stress data:",e.error),g({title:"Error",description:"Could not save your response: ".concat(e.error),variant:"destructive"}))}catch(e){console.error("Error saving stress data:",e),g({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}};if(t||!e||!_)return(0,s.jsx)("div",{className:"flex h-full items-center justify-center bg-background",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 border-4 border-dashed rounded-full animate-spin border-primary-foreground mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Loading..."})]})});let J=null===O||O<18;return(0,s.jsxs)("div",{className:"flex flex-col min-h-screen bg-background",children:[(0,s.jsxs)("header",{className:"p-4 flex justify-between items-center border-b",style:{paddingTop:"max(1rem, var(--safe-area-inset-top))",paddingLeft:"max(1rem, var(--safe-area-inset-left))",paddingRight:"max(1rem, var(--safe-area-inset-right))"},children:[(0,s.jsx)("h1",{className:"text-xl font-headline font-bold",children:"brain-kit.uk"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[U&&(0,s.jsxs)(l.$,{variant:"outline",size:"sm",onClick:()=>u.push("/admin"),className:"gap-2",children:[(0,s.jsx)(c.ek,{className:"h-4 w-4"}),"Admin"]}),(0,s.jsx)(A,{}),(0,s.jsxs)("div",{className:"text-right text-sm",children:[(0,s.jsx)("div",{children:e.email}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Participant ID: ",e.participantId]})]}),(0,s.jsxs)(l.$,{variant:"ghost",size:"icon",onClick:()=>{i(),u.push("/login")},children:[(0,s.jsx)(c.nU,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Log out"})]})]})]}),(0,s.jsx)("main",{className:"flex-grow flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md",children:["idle"===k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M,{}),(0,s.jsx)(C,{}),(0,s.jsxs)(d.Zp,{className:"shadow-lg",children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsx)(d.ZB,{className:"font-headline text-center",children:"Ready for your affirmation?"}),(0,s.jsx)(d.BT,{className:"text-center",children:"You would normally receive a notification for these."})]}),(0,s.jsxs)(d.Wu,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)(l.$,{size:"lg",onClick:()=>V("morning"),children:[(0,s.jsx)(c.mO,{className:"mr-2 h-5 w-5"}),"Morning"]}),(0,s.jsx)(v,{children:(0,s.jsxs)(x,{children:[(0,s.jsx)(w,{asChild:!0,children:(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)(l.$,{size:"lg",onClick:()=>V("evening"),disabled:J,className:"w-full",children:[J?(0,s.jsx)(c.c_,{className:"mr-2 h-5 w-5"}):(0,s.jsx)(c.dB,{className:"mr-2 h-5 w-5"}),"Evening"]})})}),J&&(0,s.jsx)(y,{children:(0,s.jsx)("p",{children:"Evening affirmation unlocks at 6 PM."})})]})})]})]})]}),"pre-stress"===k&&(0,s.jsx)(f,{title:"Before we begin, how are you feeling?",description:"Rate your current stress level from 1 (very calm) to 5 (very stressed).",onSubmit:e=>{E({...I,pre:e}),q(new Date),T("affirmation")}}),"affirmation"===k&&(0,s.jsx)(p,{affirmation:D,onContinue:()=>{G(new Date),T("post-stress")}}),"post-stress"===k&&(0,s.jsx)(f,{title:"How are you feeling now?",description:"Please rate your current stress level again.",onSubmit:X}),"complete"===k&&(0,s.jsxs)(d.Zp,{className:"shadow-lg text-center",children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsx)(d.ZB,{className:"font-headline",children:"Thank you!"}),(0,s.jsx)(d.BT,{children:"Your response has been recorded. Your participation is greatly appreciated."})]}),(0,s.jsx)(d.Wu,{children:(0,s.jsxs)(l.$,{onClick:()=>{T("idle"),E({pre:null,post:null}),P(null),Y(null),q(null),G(null)},children:["Back to Dashboard ",(0,s.jsx)(c.Qp,{className:"ml-2 h-4 w-4"})]})})]})]})}),(0,s.jsx)(L,{})]})}},6695:(e,t,i)=>{"use strict";i.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>a,aR:()=>o,wL:()=>u});var s=i(5155),r=i(2115),n=i(9434);let a=r.forwardRef((e,t)=>{let{className:i,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",i),...r})});a.displayName="Card";let o=r.forwardRef((e,t)=>{let{className:i,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",i),...r})});o.displayName="CardHeader";let l=r.forwardRef((e,t)=>{let{className:i,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",i),...r})});l.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:i,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",i),...r})});d.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:i,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",i),...r})});c.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:i,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",i),...r})});u.displayName="CardFooter"},7481:(e,t,i)=>{"use strict";i.d(t,{dj:()=>m});var s=i(2115);let r=0,n=new Map,a=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:i}=t;return i?a(i):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===i||void 0===i?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,i=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:i});return c({type:"ADD_TOAST",toast:{...t,id:i,open:!0,onOpenChange:e=>{e||s()}}}),{id:i,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:i}})}}function m(){let[e,t]=s.useState(d);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},8200:(e,t,i)=>{Promise.resolve().then(i.bind(i,3621))},9229:(e,t,i)=>{"use strict";function s(e){let t=new Date(e),i=new Date;return t.setHours(0,0,0,0),i.setHours(0,0,0,0),Math.floor((i.getTime()-t.getTime())/864e5)+1}function r(e,t){return(s(e)-1)%7*2+ +!t}function n(e){return s(e)>=7}i.d(t,{Bj:()=>r,Mm:()=>s,_n:()=>n})},9298:(e,t,i)=>{"use strict";i.d(t,{h:()=>r});var s=i(535);function r(){let{user:e}=(0,s.A)();return(null==e?void 0:e.role)==="admin"}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,644,633,366,786,895,103,441,684,358],()=>t(8200)),_N_E=e.O()}]);