"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[942],{3262:(e,t,o)=>{o.d(t,{B1:()=>n,Ir:()=>p,Ot:()=>d,Qp:()=>s,Wm:()=>c,X:()=>x,br:()=>g,c_:()=>i,dB:()=>u,ek:()=>l,f5:()=>w,mO:()=>h,nU:()=>a,sn:()=>j});var r=o(5155);let s=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("path",{d:"M5 12h14"}),(0,r.jsx)("path",{d:"m12 5 7 7-7 7"})]}),n=e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:(0,r.jsx)("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),i=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),(0,r.jsx)("polyline",{points:"16 17 21 12 16 7"}),(0,r.jsx)("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),d=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8"}),(0,r.jsx)("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"}),(0,r.jsx)("path",{d:"m16 19 2 2 4-4"})]}),l=e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:(0,r.jsx)("path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"})}),h=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("path",{d:"M12 2v8"}),(0,r.jsx)("path",{d:"m4.93 10.93 1.41 1.41"}),(0,r.jsx)("path",{d:"M2 18h2"}),(0,r.jsx)("path",{d:"M20 18h2"}),(0,r.jsx)("path",{d:"m19.07 10.93-1.41 1.41"}),(0,r.jsx)("path",{d:"M22 22H2"}),(0,r.jsx)("path",{d:"m8 6 4-4 4 4"}),(0,r.jsx)("path",{d:"M16 18a4 4 0 0 0-8 0"})]}),u=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("path",{d:"M12 10V2"}),(0,r.jsx)("path",{d:"m4.93 10.93 1.41 1.41"}),(0,r.jsx)("path",{d:"M2 18h2"}),(0,r.jsx)("path",{d:"M20 18h2"}),(0,r.jsx)("path",{d:"m19.07 10.93-1.41 1.41"}),(0,r.jsx)("path",{d:"M22 22H2"}),(0,r.jsx)("path",{d:"m16 6-4 4-4-4"}),(0,r.jsx)("path",{d:"M16 18a4 4 0 0 0-8 0"})]}),c=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),(0,r.jsx)("path",{d:"M3 5v14c0 1.7 4 3 9 3s9-1.3 9-3V5"}),(0,r.jsx)("path",{d:"M3 12c0 1.7 4 3 9 3s9-1.3 9-3"})]}),w=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,r.jsx)("polyline",{points:"7 10 12 15 17 10"}),(0,r.jsx)("line",{x1:"12",x2:"12",y1:"15",y2:"3"})]}),x=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("path",{d:"M18 6 6 18"}),(0,r.jsx)("path",{d:"m6 6 12 12"})]}),p=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"}),(0,r.jsx)("path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0"})]}),g=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5"}),(0,r.jsx)("path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7"}),(0,r.jsx)("path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0"}),(0,r.jsx)("path",{d:"m2 2 20 20"})]}),j=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,r.jsx)("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}),(0,r.jsx)("path",{d:"M12 8v8"}),(0,r.jsx)("path",{d:"m8 12 4 4 4-4"})]})},6104:(e,t,o)=>{o.d(t,{db:()=>a,y:()=>i});var r=o(3915),s=o(5317),n=o(996);let i=(0,r.Dk)().length?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyANh6YrHtu3gIfpUQPJTMpMUyPqh7YiFDU",authDomain:"affirmation-study.firebaseapp.com",projectId:"affirmation-study",storageBucket:"affirmation-study.firebasestorage.app",messagingSenderId:"27983281189",appId:"1:27983281189:web:474fc28d338072232013cc"}),a=(0,s.aU)(i,"care-kit");(0,n.TT)().then(e=>{e&&(0,n.dG)(i)})},9434:(e,t,o)=>{o.d(t,{cn:()=>n});var r=o(2596),s=o(9688);function n(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return(0,s.QP)((0,r.$)(t))}},9576:(e,t,o)=>{o.d(t,{A:()=>u,O:()=>h});var r=o(5155),s=o(2115),n=o(3004),i=o(5317),a=o(6104);let d=(0,s.createContext)(void 0),l=(0,n.xI)(a.y);function h(e){let{children:t}=e,[o,h]=(0,s.useState)(null),[u,c]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=(0,n.hg)(l,async e=>{if(console.log("onAuthStateChanged triggered, user:",null==e?void 0:e.uid),e){let t=(0,i.doc)(a.db,"users",e.uid);console.log("Fetching user document...");let o=await (0,i.x7)(t),r=0;for(;!o.exists()&&r<5;)console.log("User document not found, retry ".concat(r+1,"/").concat(5,"...")),await new Promise(e=>setTimeout(e,500)),o=await (0,i.x7)(t),r++;if(o.exists()){console.log("User document found, setting user state");let t=o.data();h({email:e.email,uid:e.uid,participantId:t.participantId,name:t.name,role:t.role||"user",memorableCodeWord:t.memorableCodeWord,studyStartDate:t.studyStartDate,hasCompletedStudy:t.hasCompletedStudy||!1})}else console.error("User document not found after retries"),await (0,n.CI)(l),h(null)}else console.log("No authenticated user"),h(null);console.log("Setting loading to false"),c(!1)});return()=>e()},[]);let w=async(e,t)=>{await (0,n.x9)(l,e,t)},x=async(e,t,o,r)=>{let s=null;try{console.log("Starting signup process..."),s=(await (0,n.eJ)(l,e,t)).user,console.log("Firebase user created:",s.uid);let d=(0,i.doc)(a.db,"users",s.uid);return console.log("Creating user document..."),await (0,i.BN)(d,{email:s.email,name:o.trim(),memorableCodeWord:r.trim().toLowerCase(),role:"user",studyStartDate:new Date().toISOString(),hasCompletedStudy:!1}),console.log("User document created successfully"),r.trim().toLowerCase()}catch(o){if(console.error("Signup error:",o),s)try{console.log("Cleaning up failed signup..."),await (0,n.x9)(l,e,t),await (0,n.hG)(l.currentUser),console.log("User cleaned up")}catch(e){console.error("Failed to clean up user during signup failure:",e)}throw o}},p=async()=>{await (0,n.CI)(l)},g=async()=>{let e=new n.HF;try{let t=(await (0,n.df)(l,e)).user,o=(0,i.doc)(a.db,"users",t.uid);if(!(await (0,i.x7)(o)).exists()){let e=await getNextParticipantId();if(e)await (0,i.BN)(o,{email:t.email,participantId:e,authProvider:"google",role:"user",studyStartDate:new Date().toISOString(),hasCompletedStudy:!1});else throw Error("Failed to generate participant ID.")}}catch(e){throw console.error("Google sign-in error:",e),e}},j=async e=>{await (0,n.J1)(l,e)};return(0,r.jsx)(d.Provider,{value:{user:o,loading:u,login:w,signup:x,signInWithGoogle:g,logout:p,sendPasswordReset:j},children:t})}function u(){let e=(0,s.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}}]);